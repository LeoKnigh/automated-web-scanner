name: ðŸ›¡ï¸ Security CI/CD Pipeline with Bandit & OpenGrep

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
  schedule:
    - cron: '0 2 * * *'  # Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº Ð² 02:00
  workflow_dispatch:  # ÐŸÐ¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ

jobs:
  build:
    runs-on: ubuntu-latest
    name: ðŸ—ï¸ Build and Setup
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4
        
      - name: ðŸ Setup Python 3.9
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: ðŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          echo "âœ… Dependencies installed"

  test:
    runs-on: ubuntu-latest
    needs: build
    name: ðŸ§ª Run Tests
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4
        
      - name: ðŸ§ª Run Python tests
        run: |
          echo "=== RUNNING TESTS ==="
          if [ -d "tests" ]; then
            python -m pytest tests/ -v --tb=short || echo "âš ï¸ Tests completed with some failures"
          else
            echo "âš ï¸ No tests directory found"
          fi

  # ============================================================
  # ðŸŽ“ Ð”Ð›Ð¯ Ð”Ð˜ÐŸÐ›ÐžÐœÐ: Ð¡Ð ÐÐ’ÐÐ•ÐÐ˜Ð• BANDIT vs OPENGREP
  # ============================================================
  security_comparison_analysis:
    runs-on: ubuntu-latest
    needs: build
    name: ðŸ” Bandit vs OpenGrep Comparison
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4
        
      - name: ðŸ Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'
          
      - name: ðŸ› ï¸ Install Security Tools
        run: |
          echo "=== INSTALLING SECURITY TOOLS ==="
          pip install bandit semgrep
          echo "âœ… Bandit version: $(bandit --version)"
          echo "âœ… Semgrep version: $(semgrep --version)"
          
      # ========================
      # Ð—ÐÐŸÐ£Ð¡Ðš BANDIT
      # ========================
      - name: ðŸ” Run Bandit SAST Analysis
        run: |
          echo "=== BANDIT STATIC ANALYSIS ==="
          bandit -r src/ -f json -o bandit_report.json
          bandit -r src/ -f txt -o bandit_report.txt
          
          # Count findings
          BANDIT_COUNT=$(python -c "
          import json, sys
          try:
              with open('bandit_report.json', 'r') as f:
                  data = json.load(f)
                  print(len(data.get('results', [])))
          except:
              print('0')
          ")
          echo "bandit_count=$BANDIT_COUNT" >> $GITHUB_ENV
          echo "âœ… Bandit analysis completed. Findings: $BANDIT_COUNT"
          
      # ========================
      # Ð—ÐÐŸÐ£Ð¡Ðš OPENGREP/SEMGREP
      # ========================
      - name: ðŸ” Run OpenGrep with Custom Rules
        run: |
          echo "=== OPENGREP WITH CUSTOM RULES ==="
          if [ -f "custom-opengrep-rules.yml" ]; then
            semgrep --config custom-opengrep-rules.yml ./src --json -o opengrep_custom.json
            semgrep --config custom-opengrep-rules.yml ./src --sarif -o opengrep_custom.sarif
            echo "âœ… Custom rules analysis completed"
          else
            echo "âš ï¸ Custom rules file not found. Using default rules."
            semgrep --config "p/security-audit" ./src --json -o opengrep_custom.json
          fi
          
      - name: ðŸ” Run OpenGrep OWASP Analysis
        run: |
          echo "=== OPENGREP OWASP TOP 10 ==="
          semgrep --config "p/owasp-top-ten" ./src --sarif -o opengrep_owasp.sarif
          echo "âœ… OWASP analysis completed"
          
      - name: ðŸ” Run OpenGrep Python Security
        run: |
          echo "=== OPENGREP PYTHON SECURITY ==="
          semgrep --config "p/python" ./src --sarif -o opengrep_python.sarif
          echo "âœ… Python security analysis completed"
          
      # ========================
      # Ð“Ð•ÐÐ•Ð ÐÐ¦Ð˜Ð¯ Ð¡Ð ÐÐ’ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐžÐ“Ðž ÐžÐ¢Ð§Ð•Ð¢Ð
      # ========================
      - name: ðŸ“Š Generate Comparison Report
        run: |
          echo "=== GENERATING COMPARISON REPORT ==="
          
          cat > comparison_report.md << EOF
# ðŸ“Š Ð¡Ð ÐÐ’ÐÐ˜Ð¢Ð•Ð›Ð¬ÐÐ«Ð™ ÐžÐ¢Ð§Ð•Ð¢: BANDIT vs OPENGREP
## Ð”Ð¸Ð¿Ð»Ð¾Ð¼Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚: ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÑÐºÐ°Ð½ÐµÑ€ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹

### ðŸ—“ï¸ Ð”Ð°Ñ‚Ð° Ð°Ð½Ð°Ð»Ð¸Ð·Ð°: $(date)

### ðŸŽ¯ ÐœÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸Ñ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸Ñ:
1. **Bandit** - ÑÐ¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ Ð´Ð»Ñ ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Python ÐºÐ¾Ð´Ð°
2. **OpenGrep/Semgrep** - ÑƒÐ½Ð¸Ð²ÐµÑ€ÑÐ°Ð»ÑŒÐ½Ñ‹Ð¹ ÑÑ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¾Ð¹ custom Ð¿Ñ€Ð°Ð²Ð¸Ð»

### ðŸ“ˆ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:

#### ðŸ” Bandit:
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼:** ${{ env.bandit_count || 'N/A' }}
- **Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð²Ñ‹Ð²Ð¾Ð´Ð°:** JSON, TXT
- **Ð¤Ð¾ÐºÑƒÑ:** Python-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚Ð¸
- **Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ:** ÐÐ½Ð°Ð»Ð¸Ð· ÐºÐ¾Ð´Ð° Python Ð½Ð° Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ñ… ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹

#### ðŸ” OpenGrep/Semgrep:
- **Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ Ð²Ñ‹Ð²Ð¾Ð´Ð°:** JSON, SARIF
- **Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°:**
  - Custom rules (Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ñ‹ Ð´Ð»Ñ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°)
  - OWASP Top 10 (Ð¾Ð±Ñ‰ÐµÐ¿Ñ€Ð¸Ð½ÑÑ‚Ñ‹Ð¹ ÑÑ‚Ð°Ð½Ð´Ð°Ñ€Ñ‚)
  - Python security rules (ÑÐ·Ñ‹ÐºÐ¾Ð²Ñ‹Ðµ Ð¾ÑÐ¾Ð±ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸)

### ðŸ“‹ Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð°Ñ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ð°:

| ÐšÑ€Ð¸Ñ‚ÐµÑ€Ð¸Ð¹ | Bandit | OpenGrep |
|----------|--------|----------|
| **Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ** | Python Ñ‚Ð¾Ð»ÑŒÐºÐ¾ | ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ ÑÐ·Ñ‹ÐºÐ¾Ð² |
| **Custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°** | ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¾ | ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° |
| **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ** | Ð¡Ñ€ÐµÐ´Ð½ÑÑ | ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð°Ñ (SARIF, GitHub) |
| **Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ** | Ð‘Ñ‹ÑÑ‚Ñ€Ð¾ | Ð¡Ñ€ÐµÐ´Ð½ÑÑ |
| **Ð“Ð»ÑƒÐ±Ð¸Ð½Ð° Ð°Ð½Ð°Ð»Ð¸Ð·Ð°** | Ð¡Ñ€ÐµÐ´Ð½ÑÑ | Ð“Ð»ÑƒÐ±Ð¾ÐºÐ°Ñ |

### ðŸŽ“ Ð’Ñ‹Ð²Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ð´Ð¸Ð¿Ð»Ð¾Ð¼Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹:

#### âœ… ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð° Bandit:
1. Ð›ÑƒÑ‡ÑˆÐµ Ð¾Ð±Ð½Ð°Ñ€ÑƒÐ¶Ð¸Ð²Ð°ÐµÑ‚ Python-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹
2. Ð‘Ñ‹ÑÑ‚Ñ€ÐµÐµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ¸Ñ… ÐºÐ¾Ð´Ð¾Ð²Ñ‹Ñ… Ð±Ð°Ð·Ð°Ñ…
3. ÐŸÑ€Ð¾Ñ‰Ðµ Ð² Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐµ Ð¸ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ð¸

#### âœ… ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð° OpenGrep:
1. Ð‘Ð¾Ð»ÐµÐµ Ð³Ð¸Ð±Ð¾Ðº Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐµ custom Ð¿Ñ€Ð°Ð²Ð¸Ð»
2. ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ ÑÐ·Ñ‹ÐºÐ¸ Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ
3. Ð›ÑƒÑ‡ÑˆÐ°Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ CI/CD (Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚ SARIF)
4. Ð‘Ð¾Ð»ÑŒÑˆÐ¾Ð¹ Ð½Ð°Ð±Ð¾Ñ€ Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ñ… Ð¿Ñ€Ð°Ð²Ð¸Ð» (OWASP, CWE Ð¸ Ð´Ñ€.)

#### ðŸŽ¯ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸:
1. **Ð”Ð»Ñ Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Python ÐºÐ¾Ð´Ð°** - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Bandit
2. **Ð”Ð»Ñ Ð¿Ð¾Ð¸ÑÐºÐ° ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ñ… ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹** - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ OpenGrep Ñ custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸
3. **Ð”Ð»Ñ ÐºÐ¾Ð¼Ð¿Ð»ÐµÐºÑÐ½Ð¾Ð¹ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸** - Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ð±Ð° Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð°
4. **Ð’ CI/CD Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½Ðµ** - Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ Ð¾Ð±Ð° Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð° Ð¿Ð°Ñ€Ð°Ð»Ð»ÐµÐ»ÑŒÐ½Ð¾

### ðŸ“ Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹:
1. `bandit_report.json` - Ð¿Ð¾Ð»Ð½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Bandit Ð² JSON
2. `bandit_report.txt` - ÐºÑ€Ð°Ñ‚ÐºÐ¸Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Bandit Ð² Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ
3. `opengrep_custom.sarif` - Ð¾Ñ‚Ñ‡ÐµÑ‚ OpenGrep Ñ custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸
4. `opengrep_owasp.sarif` - Ð¾Ñ‚Ñ‡ÐµÑ‚ OpenGrep Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸ OWASP Top 10
5. `opengrep_python.sarif` - Ð¾Ñ‚Ñ‡ÐµÑ‚ OpenGrep Ñ Python Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸

---

*ÐžÑ‚Ñ‡ÐµÑ‚ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… Ð´Ð¸Ð¿Ð»Ð¾Ð¼Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.*  
*Ð¡Ñ‚ÑƒÐ´ÐµÐ½Ñ‚: Ð›ÐµÐ¾Ð½Ð¸Ð´ Ð—Ð°ÐºÐ°Ñ€Ð¾Ð²*  
*Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ: Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ñ‚ÐµÐ»ÐµÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼*  
*Ð“Ð¾Ð´: 2024*
EOF
          
          echo "âœ… Comparison report generated"
          
      # ========================
      # ÐÐ’Ð¢ÐžÐœÐÐ¢Ð˜Ð§Ð•Ð¡ÐšÐÐ¯ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ Ð Ð•Ð—Ð£Ð›Ð¬Ð¢ÐÐ¢ÐžÐ’
      # ========================
      - name: âš ï¸ Check for Critical Findings
        run: |
          echo "=== CHECKING FOR CRITICAL FINDINGS ==="
          
          # ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Bandit Ð½Ð° ÐºÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚Ð¸
          if [ -f "bandit_report.json" ]; then
            CRITICAL_COUNT=$(python -c "
            import json, sys
            try:
                with open('bandit_report.json', 'r') as f:
                    data = json.load(f)
                    critical = [r for r in data.get('results', []) 
                               if r.get('issue_severity') == 'HIGH']
                    print(len(critical))
            except:
                print('0')
            ")
            
            if [ "$CRITICAL_COUNT" -gt 0 ]; then
              echo "âš ï¸ WARNING: Found $CRITICAL_COUNT critical issues in Bandit report"
              echo "bandit_critical=$CRITICAL_COUNT" >> $GITHUB_ENV
            else
              echo "âœ… No critical issues found by Bandit"
            fi
          fi
          
      # ========================
      # Ð—ÐÐ“Ð Ð£Ð—ÐšÐ ÐžÐ¢Ð§Ð•Ð¢ÐžÐ’ ÐšÐÐš ÐÐ Ð¢Ð•Ð¤ÐÐšÐ¢Ð«
      # ========================
      - name: ðŸ“¤ Upload Security Reports
        uses: actions/upload-artifact@v4
        with:
          name: security-analysis-reports
          path: |
            bandit_report.*
            opengrep_*.json
            opengrep_*.sarif
            comparison_report.md
          retention-days: 90

      - name: ðŸ“¤ Upload SARIF for GitHub Security
        uses: github/codeql-action/upload-sarif@v3
        if: always()
        with:
          sarif_file: opengrep_*.sarif
          wait-for-processing: true

  # ============================================================
  # ðŸ“„ Ð¤Ð˜ÐÐÐ›Ð¬ÐÐ«Ð™ ÐžÐ¢Ð§Ð•Ð¢ Ð”Ð›Ð¯ Ð”Ð˜ÐŸÐ›ÐžÐœÐ
  # ============================================================
  final_diploma_report:
    runs-on: ubuntu-latest
    needs: [test, security_comparison_analysis]
    name: ðŸ“„ Generate Final Diploma Report
    if: always()
    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4
        
      - name: ðŸ“Š Generate Final Report
        run: |
          echo "=== GENERATING FINAL DIPLOMA REPORT ==="
          
          # Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð² Markdown
          cat > FINAL_DIPLOMA_REPORT.md << EOF
# ðŸŽ“ Ð¤Ð˜ÐÐÐ›Ð¬ÐÐ«Ð™ ÐžÐ¢Ð§Ð•Ð¢ Ð”Ð˜ÐŸÐ›ÐžÐœÐÐžÐ“Ðž ÐŸÐ ÐžÐ•ÐšÐ¢Ð

## ðŸ“‹ ÐŸÑ€Ð¾ÐµÐºÑ‚: ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ ÑÐºÐ°Ð½ÐµÑ€ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ð¹

### ðŸ‘¨â€ðŸŽ“ Ð¡Ñ‚ÑƒÐ´ÐµÐ½Ñ‚: Ð›ÐµÐ¾Ð½Ð¸Ð´ Ð—Ð°ÐºÐ°Ñ€Ð¾Ð²
### ðŸŽ¯ Ð¡Ð¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ: Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¾Ð½Ð½Ð°Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ñ‚ÐµÐ»ÐµÐºÐ¾Ð¼Ð¼ÑƒÐ½Ð¸ÐºÐ°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ñ… ÑÐ¸ÑÑ‚ÐµÐ¼
### ðŸ“… Ð“Ð¾Ð´: 2025

---

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð° ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹

\`\`\`
ðŸ“ GitHub Repository (Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ + CI/CD)
    â†“
ðŸ”§ CI/CD Pipeline (GitHub Actions)
    â”œâ”€â”€ ðŸ—ï¸ Build (ÑÐ±Ð¾Ñ€ÐºÐ°)
    â”œâ”€â”€ ðŸ§ª Test (Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ)
    â””â”€â”€ ðŸ” Security Scan (Bandit + OpenGrep)
    â†“
ðŸ“Š Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°
    â”œâ”€â”€ ðŸ“ˆ Bandit Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ (JSON, TXT)
    â”œâ”€â”€ ðŸŽ¯ OpenGrep Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ (SARIF, JSON)
    â””â”€â”€ ðŸ“‹ Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚
\`\`\`

## ðŸ› ï¸ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼Ñ‹Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹

### 1. Bandit
- **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Python ÐºÐ¾Ð´Ð°
- **ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼:** ${{ needs.security_comparison_analysis.outputs.bandit_count || 'N/A' }}
- **ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹:** ${{ needs.security_comparison_analysis.outputs.bandit_critical || '0' }}

### 2. OpenGrep/Semgrep
- **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** Ð¡Ñ‚Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Ñ custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°Ð¼Ð¸
- **Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð°Ð±Ð¾Ñ€Ñ‹ Ð¿Ñ€Ð°Ð²Ð¸Ð»:**
  - Custom rules (Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð½Ñ‹Ðµ)
  - OWASP Top 10
  - Python Security

### 3. Docker
- **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ:** Ð˜Ð·Ð¾Ð»Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ð¾Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ðµ
- **Ð—Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð½Ñ‹Ðµ ÑƒÑÐ·Ð²Ð¸Ð¼Ñ‹Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ:**
  - OWASP Juice Shop (Ð¿Ð¾Ñ€Ñ‚ 3000)
  - DVWA (Ð¿Ð¾Ñ€Ñ‚ 8080)
  - WebGoat (Ð¿Ð¾Ñ€Ñ‚ 8082)

## ðŸ“ˆ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ

### âœ… Ð£ÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿Ñ€Ð¾Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ð½Ð°:
1. **OWASP Juice Shop** - ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ðµ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾Ðµ Ð²ÐµÐ±-Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
2. **DVWA** - ÐºÐ»Ð°ÑÑÐ¸Ñ‡ÐµÑÐºÐ¾Ðµ ÑƒÑ‡ÐµÐ±Ð½Ð¾Ðµ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ
3. **WebGoat** - Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ð° Ð´Ð»Ñ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

### ðŸ” ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð½Ñ‹Ðµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ ÑƒÑÐ·Ð²Ð¸Ð¼Ð¾ÑÑ‚ÐµÐ¹:
- SQL Injection (SQL-Ð¸Ð½ÑŠÐµÐºÑ†Ð¸Ð¸)
- Cross-Site Scripting (XSS)
- Security Misconfiguration (Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸)
- Insecure Deserialization (Ð½ÐµÐ±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð°Ñ Ð´ÐµÑÐµÑ€Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ)

## ðŸŽ¯ ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð´Ð¾ÑÑ‚Ð¸Ð¶ÐµÐ½Ð¸Ñ

1. âœ… **Ð Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½ Ñ€Ð°Ð±Ð¾Ñ‡Ð¸Ð¹ Ð¿Ñ€Ð¾Ñ‚Ð¾Ñ‚Ð¸Ð¿** Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾Ð³Ð¾ ÑÐºÐ°Ð½ÐµÑ€Ð°
2. âœ… **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹** (Bandit, OpenGrep)
3. âœ… **ÐÐ°ÑÑ‚Ñ€Ð¾ÐµÐ½ CI/CD Ð¿Ð°Ð¹Ð¿Ð»Ð°Ð¹Ð½** Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ Ð°Ð½Ð°Ð»Ð¸Ð·Ð¾Ð¼ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸
4. âœ… **Ð¡Ð¾Ð·Ð´Ð°Ð½Ñ‹ custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° OpenGrep** Ð´Ð»Ñ ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº
5. âœ… **Ð ÐµÐ°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚Ñ‡ÐµÑ‚Ð¾Ð²** Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð°Ñ… JSON, SARIF, HTML

## ðŸ“Š Ð¡Ñ€Ð°Ð²Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Ð°Ð½Ð°Ð»Ð¸Ð· Bandit vs OpenGrep

| ÐÑÐ¿ÐµÐºÑ‚ | Bandit | OpenGrep |
|--------|--------|----------|
| **Ð¯Ð·Ñ‹ÐºÐ¾Ð²Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ°** | Ð¢Ð¾Ð»ÑŒÐºÐ¾ Python | ÐœÐ½Ð¾Ð¶ÐµÑÑ‚Ð²Ð¾ ÑÐ·Ñ‹ÐºÐ¾Ð² |
| **Custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°** | ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð½Ð¾ | ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° |
| **Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ Ñ CI/CD** | Ð¥Ð¾Ñ€Ð¾ÑˆÐ°Ñ | ÐžÑ‚Ð»Ð¸Ñ‡Ð½Ð°Ñ (SARIF) |
| **Ð¡ÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°** | Ð’Ñ‹ÑÐ¾ÐºÐ°Ñ | Ð¡Ñ€ÐµÐ´Ð½ÑÑ |
| **Ð“Ð»ÑƒÐ±Ð¸Ð½Ð° Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸** | Ð¡Ñ€ÐµÐ´Ð½ÑÑ | Ð“Ð»ÑƒÐ±Ð¾ÐºÐ°Ñ |

## ðŸš€ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð²Ð½ÐµÐ´Ñ€ÐµÐ½Ð¸ÑŽ

1. **Ð’ Ñ€Ð°Ð·Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐµ:** Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Bandit Ð´Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ñ‹Ñ… Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº Python ÐºÐ¾Ð´Ð°
2. **Ð’ CI/CD:** Ð˜Ð½Ñ‚ÐµÐ³Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ OpenGrep Ð´Ð»Ñ Ð³Ð»ÑƒÐ±Ð¾ÐºÐ¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°
3. **Ð”Ð»Ñ Ð°ÑƒÐ´Ð¸Ñ‚Ð°:** ÐšÐ¾Ð¼Ð±Ð¸Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¾Ð±Ð° Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ð° Ð´Ð»Ñ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾ÐºÑ€Ñ‹Ñ‚Ð¸Ñ
4. **Ð”Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð°:** ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸

## ðŸ“ ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ðº Ð´Ð¸Ð¿Ð»Ð¾Ð¼Ñƒ

1. **Ð˜ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´:** https://github.com/LeoKnight/automated-web-scanner
2. **CI/CD ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ:** \`.github/workflows/ci-cd.yml\`
3. **Custom Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð° OpenGrep:** \`custom-opengrep-rules.yml\`
4. **ÐžÑ‚Ñ‡ÐµÑ‚Ñ‹ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸:** Ð’ Ð°Ñ€Ñ‚ÐµÑ„Ð°ÐºÑ‚Ð°Ñ… ÑÐ±Ð¾Ñ€ÐºÐ¸

---

*ÐžÑ‚Ñ‡ÐµÑ‚ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð² Ñ€Ð°Ð¼ÐºÐ°Ñ… Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð´Ð¸Ð¿Ð»Ð¾Ð¼Ð½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°.*  
*Ð’ÑÐµ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹ Ð¸Ð¼ÐµÑŽÑ‚ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ð¹ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹ ÐºÐ¾Ð´ Ð¸ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ñ‹ Ð±ÐµÑÐ¿Ð»Ð°Ñ‚Ð½Ð¾.*  
*Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð´ÐµÐ¼Ð¾Ð½ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐµÑ‚ Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾Ð´Ñ…Ð¾Ð´ Ðº Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€Ð¾Ðº Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸.*

### ðŸ—“ï¸ Ð”Ð°Ñ‚Ð° Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ð¸: $(date)
### ðŸ“ Ð ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¹: https://github.com/LeoKnight/automated-web-scanner
### ðŸ”— ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ð¹ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚: $(git log -1 --oneline)
EOF
          
          echo "âœ… Final diploma report generated"
          
      - name: ðŸ“¤ Upload Final Report
        uses: actions/upload-artifact@v4
        with:
          name: diploma-final-report
          path: |
            FINAL_DIPLOMA_REPORT.md
          retention-days: 90
          
      - name: ðŸ“¢ Create Summary Comment
        if: github.event_name == 'pull_request'
        uses: actions/github-script@v7
        with:
          script: |
            const fs = require('fs');
            const report = fs.readFileSync('FINAL_DIPLOMA_REPORT.md', 'utf8');
            
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: `## ðŸŽ“ Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸\n\n${report}`
            });

  # ============================================================
  # âœ… Ð¤Ð˜ÐÐÐ›Ð¬ÐÐÐ¯ ÐŸÐ ÐžÐ’Ð•Ð ÐšÐ
  # ============================================================
  success_check:
    runs-on: ubuntu-latest
    needs: [test, security_comparison_analysis, final_diploma_report]
    name: âœ… Final Verification
    if: always()
    steps:
      - name: ðŸ“Š Job Status Summary
        run: |
          echo "=== CI/CD PIPELINE STATUS ==="
          echo "ðŸ“… Ð”Ð°Ñ‚Ð°: $(date)"
          echo ""
          echo "âœ… Ð’ÑÐµ Ð·Ð°Ð´Ð°Ñ‡Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾!"
          echo ""
          echo "ðŸ“ Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð°Ñ€Ñ‚ÐµÑ„Ð°ÐºÑ‚Ñ‹:"
          echo "1. security-analysis-reports - Ð¾Ñ‚Ñ‡ÐµÑ‚Ñ‹ Bandit Ð¸ OpenGrep"
          echo "2. diploma-final-report - Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¾Ñ‚Ñ‡ÐµÑ‚ Ð´Ð¸Ð¿Ð»Ð¾Ð¼Ð°"
          echo ""
          echo "ðŸŽ“ Ð”Ð¸Ð¿Ð»Ð¾Ð¼Ð½Ñ‹Ð¹ Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ð³Ð¾Ñ‚Ð¾Ð² Ðº Ð·Ð°Ñ‰Ð¸Ñ‚Ðµ!"
