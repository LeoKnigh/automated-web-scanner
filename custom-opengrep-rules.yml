rules:
  - id: sql-injection-detection
    patterns:
      - pattern: |
          $QUERY = "...$USER_INPUT..."
          execute($QUERY)
      - pattern: |
          "SELECT ... FROM ... WHERE ..." + $USER_INPUT
    message: "Potential SQL Injection: user input concatenated with SQL query"
    languages: [python]
    severity: ERROR
    metadata:
      category: "security"
      technology: ["python", "sql"]
      cwe: "CWE-89"
      
  - id: xss-vulnerability
    patterns:
      - pattern: |
          echo $USER_INPUT
      - pattern: |
          print($USER_INPUT)
      - pattern: |
          response.write($USER_INPUT)
    message: "Potential XSS vulnerability: user input directly output"
    languages: [python]
    severity: WARNING
    metadata:
      category: "security"
      cwe: "CWE-79"
      
  - id: hardcoded-secrets
    patterns:
      - pattern: |
          password = "..."
      - pattern: |
          api_key = "..."
      - pattern: |
          secret = "..."
      - pattern: |
          token = "..."
    message: "Hardcoded secret detected"
    languages: [python]
    severity: ERROR
    metadata:
      category: "security"
      cwe: "CWE-798"
      
  - id: unsafe-deserialization
    pattern: |
      pickle.loads(...)
    message: "Unsafe deserialization using pickle module"
    languages: [python]
    severity: ERROR
    metadata:
      category: "security"
      cwe: "CWE-502"
      
  - id: command-injection
    patterns:
      - pattern: |
          subprocess.call(..., shell=True)
      - pattern: |
          os.system(...)
    message: "Potential command injection via shell execution"
    languages: [python]
    severity: ERROR
    metadata:
      category: "security"
      cwe: "CWE-78"
      
  - id: weak-cryptography
    patterns:
      - pattern: |
          hashlib.md5(...)
      - pattern: |
          hashlib.sha1(...)
    message: "Use of weak cryptographic hash function"
    languages: [python]
    severity: WARNING
    metadata:
      category: "security"
      cwe: "CWE-327"
      
  - id: ssl-verification-disabled
    pattern: |
          verify=False
    message: "SSL certificate verification disabled"
    languages: [python]
    severity: ERROR
    metadata:
      category: "security"
      cwe: "CWE-295"
